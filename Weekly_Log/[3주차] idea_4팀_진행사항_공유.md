# [3주차] 4팀 팀플 진행상황 공유

## 팀 구성원, 개인 별 역할

---

**팀 구성원**

- 팀장 : 전현진
- 팀원 : 곽유진, 김혜주, 박경서, 손설빈

**역할**

- 공통 역할
    - 현재까지 진행한 코드 병합 및 테스트
- 개인별 역할
    - **곽유진**
        - 여행 일정 CRUD 기능 구현
            - 여행 일정 생성 기능 구현 → 전국 도시 cities 테이블에 데이터 삽입, 채팅방&팀 동시 생성
            - 여행 일정 수정 기능 구현 → 날짜 제외 여행 관련 데이터 수정 가능 (추후 날짜 수정 가능하게 구현 할 예정)
            - 여행 일정 조회 기능 구현 → 여행 아이디로 일정 조회, 사용자 아이디로 일정 리스트 조회
            - 여행 일정 삭제 기능 구현 → 여행 일정, 채팅방, 팀 전부 삭제
            - 다른 사용자의 일정 가져오기 기능 구현 → 날짜 수정이 안 되어 있어 여행 일정을 그대로 가져오게 구현 (이제 코드 정리 후 풀리퀘 올리면 됨)
    - 김혜주
        - 카카오맵 API 기능 구현
            - 검색 결과 항목을 [선택]하면 지도에 마커가 순서대로 표시됩니다.
            - 검색 결과 항목을 [제거]하면 지도에서 마커가 사라지고 마커의 번호가 알맞게 재정렬됩니다.
            - 지도에 마커가 추가되면 모든 마커가 보이도록 지도 범위를 재설정합니다.
            - [선택 완료] 버튼을 누르면 백단으로 선택한 항목들의 장소 데이터가 전송됩니다.
    - 박경서
        - 회원가입 기능 추가 및 로그인 인증/인가
            - 닉네임 자동 생성 기능 및 이메일 인증
            - JWT 방식으로 로그인 구현
            - 회원 수정 기능
            - OAuth2 로그인 기능 구현 (카카오, 네이버, 구글)
    - 손설빈
        - 일행 모집 게시판 기능 구현
            - 게시판 crud 기능 구현 → *생성 로직 수정 필요 (여행 일정 조회 api 사용)*
            - 댓글 및 대댓글 기능 구현
            - 좋아요 기능 구현
        - 후기 게시판 기능 구현
            - 게시판 crud 기능 구현 → *생성 로직 수정 필요 (여행 일정 조회 api 사용) → 장소별 후기 기능* *추가 구현 필요*
            - 댓글 및 대댓글 기능 구현
            - 좋아요 기능 구현
    - 전현진
        - 웹소캣과 카프카를 이용한 채팅 시스템 구현
            - SecurityContext로 사용자를 받아와 채팅을 진행하는 방식

              → JWT accessToken을 통해 사용자를 받아와 채팅을 진행하는 방식

            - 여행을 함께하는 팀에 사용자가 존재하지 않는다면 채팅방에 참여할 수 없도록 기능을 추가하는 중입니다
## 팀 내부 회의 진행 회차 및 일자

---

- **1회차 (2024.08.05)**: 디스코드 및 슬랙 회의 (모두 참석)
- **2회차 (2024.08.06)**: 디스코드 및 슬랙 회의 (모두 참석)
- **3회차 (2024.08.07)**: 디스코드 및 슬랙 회의 (모두 참석)
- **4회차 (2024.08.08)**: 디스코드 및 슬랙 회의 (모두 참석)
- **5회차 (2024.08.09)**: 디스코드 및 슬랙 회의 (모두 참석)

## 현재까지 개발 과정 요약 (최소 500자 이상)

---

- **곽유진**
    - 새로 알게된 점
        - 연관관계가 복잡하다보니 자잘하게 실수가 많았다.
            - not-null property references a null or transient value 오류 발생

          → 특정 컬럼이 null을 허용하지 않는데 null 값이 입력되었을 때 발생

          → ManyToMany 관계 삭제하는 과정에서 올바르게 해제하지 않으면 삭제된 엔티티를 참조하는 다른 엔티티에서 오류가 남

            - SyntaxError: Unexpected token '<’ 오류 발생

          → 기본 생성자를 추가하지 않아서 JSON을 Java 객체로 변환할 때 발생

            - 그 외에도 많은 에러가 나왔다… 코드 작성보다 에러 찾는 부분에 시간을 많이 쏟은 것 같다.
    - 어려웠던 점
        - 연관관계가 너무 많아서 다루기 힘들었다.
        - 일정 생성할 때 dto로 응답을 보내니까 오류가 떠서 성공 메세지로 응답이 되게 수정했다.
    - 아쉬운 점
        - 더 깔끔하고 명료하게 코드를 수정하고 싶었지만 수정하는 순간 오류가 나서 그대로 놔두었다..ㅎㅎ 다음에 시간이 된다면 리팩토링을 진행해보고 싶다.
        - js에 대해 잘 몰라서 거의 챗지피티와 함께 작성했다😳 다음에 꼭 공부해봐야겠다.
        - 아직 모르는 게 많아서 쉽게 구현할 수 있는 부분도 어렵게 빙 돌아가는 느낌이다.. 노력해야겠다 🔥


- 김혜주
    - 새로 알게된 점
        - 카카오 지도가 REST API 문서랑 JS 구현 문서가 있어서 REST API 문서를 따로 호출해야 하는 줄 알았는데 JS 구현 함수 자체에 값이 다 들어 있어서 JS 데이터 그대로 백단으로 넘겨주면 되는 걸 알게 되었다.
        - 부동소수점 문제를 겪고 소수 사용 시 주의해야겠다는 생각이 들었다.
    - 어려웠던 점
        - 자바스크립트로 지도 기능을 향상시키려면 API 관련 함수, 메서드, 매개변수들을 알아야 했는데 종류가 너무 많아서 파악하는 게 어려웠다😖
        - 배열 안에 있는 객체 구조를 살펴보려고 콘솔에 찍어봤는데 객체 안에 있는 속성들은 무슨 속성인지도 잘 모르겠고 이름도 이상하고.. 프로토타입(?)이라는 걸 눌러야 객체에서 사용할 수 있는 메서드들이 나와서 구조 파악하는 게 어려웠다😱
        - 부동소수점 문제 🔢
            - 위도, 경도 값을 불러와서 같은 값이면 같은 장소로 취급하려고 비교하는데 어떤 장소는 같은 값으로 잘 나오는데, 어떤 장소는 같은 장소인데도 다른 값이 나와서 다른 장소로 취급 됐다.

              → 알고보니 부동소수점 문제로 위도, 경도의 소수점 아래 마지막 숫자가 다르게 나올 때가 있어서 오차범위를 지정해주어서 해결했다.

        - 마커에 부여된 숫자가 index가 아닌 index+1으로 나타나던 문제 🔽
            - 카카오 지도 API에서 기본 제공해 주는 마커 이미지의 이미지 영역 좌표가 문제 원인이었다. 마커 이미지는 하나하나 개별로 된 게 아닌 아래와 같이 하나의 png 파일로 되어있었다.

              → 즉, 지도에 마커 이미지를 나타낼 때는 마커 이미지(스프라이트 이미지) 내에서 크기와 좌표로 사용할 영역 외엔 다 감춰지게 잘라서 화면에 나타내는 것이었다. 코드 내에 index-1으로 설정해 줌으로써 해결

    - 아쉬운 점
        - 외부 API 문서를 읽어본 경험이 없다 보니 API 구조랑 관련 메서드를 파악하는데 시간이 많이 걸려 아쉬웠다.


- 박경서
    - 새로 알게된 점
        - 인증과 인가에 대해서 한번 구현해봐서 할만하다고 생각했는데 시작부터 충돌이 일어나고 클라이언트로 토큰이 저장이 안되는 오류부터 403오류 등등… 별별 오류를 다 만나니깐 조금 힘들었다. 하지만 이 과정에서 겪었던 이슈와 해결 방법을 정리해두고 계속 공부해 나가면서 성장하는 느낌이 들었다.
        - 공식문서를 자주 활용해야겠다. 일단 스프링 시큐리티가 버전이 올라가면서 구글링을 통한 블로그 구현 방식이 달라졌고 처음에는 공식 문서를 참고하지 않고 다른 사람의 코드를 응용할려고 했던 것이 문제의 원인인 것 같다. 그래서 시간을 많이 소모했다.
    - 어려웠던 점
        - 토큰 저장 위치에 대해서 많은 고민을 했다. 구글링을 하면 엑세스 토큰을 로컬스토리지에 담아서 인증/인가를 하던데… 지금 팀 프로젝트가 서버와 클라이언트가 분리된 환경이 아니라서 클라이언트의 로컬스토리지에 접근할 수 없는 걸로 알고 있는데 잘 모르겠다.. 그래서 엑세스, 리프레시 토큰 둘다 쿠키에 저장했는데 이것도 보안상 안좋은 것 같고 잘 모르겠다.
        - 자바스크립트가 너무 이해가 안간다!! 최대한 지피티 사용없이 구글링과 혼자 해볼려고 코드를 짜서 실행을 하면 자꾸 오류가 난다. 한번도 그냥 통과된 적이 없다… 자바스크립트를 100% 이해를 하고 사용하는게 아니다보니 이런 문제가 생기는 것 같다.
    - 아쉬운 점
        - 코드가 깔끔하지 않다는 생각이 든다. 맡은 기능을 다 구현한 다음에 코드 리팩토링을 해볼 예정이다.


- 손설빈
    - 새로 알게된 점
        - builder 패턴
            - setter 사용을 지양하기 위해 builder 패턴을 활용했는데 공부할 수 있는 계기가 되어 좋았다.
    - 어려웠던 점
        - 개발을 진행하면서 엔티티의 양방향, 단방향 관계가 헷갈렸다.
    - 아쉬운 점
        - 프론트단 구현을 할때 챗지피티에 너무 의존해서 아쉬웠다. 자바스크립트는 너무 어렵다.
        - 대부분의 기능이 블로그 프로젝트 요구사항에 있던 기능들인데, 왜 그때는 구현하지못했는지 아쉬움이 남는다. 하지만 이렇게 팀프로젝트로 구현해볼 수 있어서 좋았다.


- 전현진
    - 새로 알게된 점
        - Claims 객체를 생성할 때 기본 클레임인 subject를 username으로 생성하면 토큰에서 username을 받아올 때 claims.get(”username”)으로 받아오는 것이 아닌 claims.getSubject()로 받아와야된다는 점을 알게되었다.
    - 어려웠던 점
        - HttpSessionHandshakeInterceptor에서 beforeHandshake의 메서드는 매개변수로 ServletServerHttpRequest를 받는데 이를 통해 HttpServletRequest 객체를 생성하고 쿠키에 담긴 토큰을 가져오는 방식에서 시간을 좀 많이 쓴거같다.
    - 아쉬운 점
        - 컴퓨터가 너무 말썽이라서 개발속도에 지장을 주는 것이 아쉽다.

## 개발 과정에서 나왔던 질문 (최소 200자 이상)

---

Q. spring security의 Authentication를 사용하여 인증정보 가져오기 VS JWT를 사용하여 인증정보 가져오기
- Authentication
  - Authentication은 세션기반 인증이며 SecurityContextHolder를 사용한다
  - 서버가 세션을 관리하므로 상태 유지를 쉽게 할 수 있다.
  - 세션이 서버에서 관리되므로, 보안 통제가 상대적으로 쉽다.
- JWT
  - 서버가 무상태(stateless)로 인증을 처리할 수 있다.
  - 서버가 상태를 유지하지 않으므로, 확장성이 뛰어나다.
  - 토큰이 클라이언트 측에 저장되므로, 서버의 부하가 적다.


Q. 그럼 현업에서는 무엇을 쓸까?
- 상황에 따라 적절할 것을 골라 써야겠죠..  이해하고 있는 것처럼 Authentication은 세션을 통해 관리되니까 상태유지가쉽고, 보안에 강력하고,  대신에 확장성이나 서버의 부하가 증가할 수 있을 거예요.   그래서 Authentication 을 이용한 인증은 사용자가 적고, 세션기반 보안을 강화할때 적합해요.   내부 관리 시스템이나, 기업 내부에서 사용하는 애플리 케이션 등에서 많이 사용될 수 있을 것 같아요.
- JWT인증은 모바일애플리케이션이나 SPA 와 같은 클라이언트 중심 어플리케이션에서 많이 사용하고,  MSA 나 여러 서버에 걸친 분산 시스템에서 인증이 필요할 때 많이 사용합니다.
- 그러나 늘 그렇듯..  항상 정답이 있는 것은 아니고,  프로젝트의 특징에 따라서 잘 결정해야하는게 숙제 입니다.



## 개발 결과물 공유

---

Github Repository URL: 레포 주소는 다음주 안으로 생성해서 작성하겠습니다

- 필수) 팀원들과 함께 찍은 인증샷(온라인 만남시 스크린 캡쳐)도 함께 업로드 해주세요 🙂

<details>
<summary><b>사진</b></summary>
<img width="200" height="200" alt="스크린샷 2024-08-13 13 49 59" src="https://file.notion.so/f/f/c69962b0-3951-485b-b10a-5bb29576bba8/11354ba7-95c8-4a71-b1c9-f02c1c0e5599/Untitled.png?table=block&id=b6ad0095-e017-4452-85d7-a8c42972aae6&spaceId=c69962b0-3951-485b-b10a-5bb29576bba8&expirationTimestamp=1723694400000&signature=uBQFbVFBDkivcqChCru3zXQYf7MJkPt-85nN0O0MMXo&downloadName=Untitled.png"> 
| <img width="200" height="200" alt="스크린샷 2024-08-13 13 50 07" src="https://file.notion.so/f/f/c69962b0-3951-485b-b10a-5bb29576bba8/35195bb0-c9a5-4111-9d39-32f0dd1f0036/Untitled.png?table=block&id=03588bdb-4b0e-484f-ba43-a4829be9739c&spaceId=c69962b0-3951-485b-b10a-5bb29576bba8&expirationTimestamp=1723694400000&signature=xxPmHiuzwQJNkzA0l5DYm1EcUK-ceB18G9W1NntFEz8&downloadName=Untitled.png"> 
| <img width="200" height="200" alt="스크린샷 2024-08-13 13 50 07" src="https://file.notion.so/f/f/c69962b0-3951-485b-b10a-5bb29576bba8/65d9d7fd-2e6b-4b9c-ad75-9535e3a667e3/%ED%99%94%EB%A9%B4_%EC%BA%A1%EC%B2%98_2024-08-09_174439.png?table=block&id=1f5fa363-9900-4d30-bc08-5a8bee0d6c99&spaceId=c69962b0-3951-485b-b10a-5bb29576bba8&expirationTimestamp=1723694400000&signature=apX39-TgFLyJaBHB9-NY-BcEQsG4ekAENGlWdxmZH-8&downloadName=%ED%99%94%EB%A9%B4+%EC%BA%A1%EC%B2%98+2024-08-09+174439.png">
| <img width="200" height="200" alt="스크린샷 2024-08-13 13 50 07" src="https://file.notion.so/f/f/c69962b0-3951-485b-b10a-5bb29576bba8/ac1c8af0-8a20-46b3-b2cd-f720f9511eae/Untitled.png?table=block&id=c8fcf219-f6f4-414b-9e14-044c150337c6&spaceId=c69962b0-3951-485b-b10a-5bb29576bba8&expirationTimestamp=1723694400000&signature=iuBzIof64qv4dvozMA-I5CLu3YVE5WdE9WBIssp1JZU&downloadName=Untitled.png">

- 설빈님 조퇴
</details>